
  <div class="row">
    <div class="col-md-12" data-animate-effect="fadeInLeft">
      <form (ngSubmit)="onSubmit()">
        <mat-progress-bar  *ngIf="spinner" mode="indeterminate"></mat-progress-bar>
        <div *ngFor="let msg of msgs" class="text-center">
          <span *ngIf="msg.summary" class="error" [innerHTML]="msg.summary"></span>
          <span *ngIf="msg.detail" class="success" [innerHTML]="msg.detail"></span>
        </div>
     
         Booking for {{property.name}}'s {{room.name}}
        <div class="form-group">
          <mat-form-field class="col-md-6" color="accent" appearance="outline">
            <input matInput [matDatepicker]="fromdate" placeholder="Check-In" [formControl]="bookingFromDate"
              [(ngModel)]="booking.fromDate"  [min]="todayDate"   
              (dateInput)="setCheckOutDate('input', $event)" (dateChange)="setCheckOutDate('change', $event)"
              required>
            <mat-error *ngIf="!bookingFromDate.valid && bookingFromDate.touched">Check-In date required</mat-error>
            <mat-datepicker-toggle matSuffix [for]="fromdate">
              <mat-icon matDatepickerToggleIcon>calendar_today</mat-icon>
            </mat-datepicker-toggle>
            <mat-datepicker #fromdate color="accent"></mat-datepicker>

          </mat-form-field>
          <mat-form-field class="col-md-6" color="accent" appearance="outline">
            <input matInput [matDatepicker]="todate" placeholder="Check-Out" [formControl]="bookingToDate"  [(ngModel)]="booking.toDate"
             [min]="minToDate" [max]="maxToDate" required>
            <mat-error *ngIf="!bookingToDate.valid && bookingToDate.touched">Check-Out date required</mat-error>
            <mat-datepicker-toggle matSuffix [for]="todate">
              <mat-icon matDatepickerToggleIcon>calendar_today</mat-icon>
            </mat-datepicker-toggle>
            <mat-datepicker #todate color="accent"></mat-datepicker>
          </mat-form-field>
        </div>
        <div *ngIf="availabilityCheck">
          <div class="form-group">
            <mat-form-field class="col-md-6" color="accent" appearance="outline">
              <input type="text" matInput placeholder="First Name" [formControl]="firstName" [(ngModel)]="booking.firstName"
                required>
              <mat-error *ngIf="!firstName.valid && firstName.touched">First Name is required</mat-error>
            </mat-form-field>
          </div>
          <div class="form-group">
            <mat-form-field class="col-md-6" color="accent" appearance="outline">
              <input type="text" matInput placeholder="Last Name" [formControl]="lastName" [(ngModel)]="booking.lastName"
                required>
              <mat-error *ngIf="!lastName.valid && lastName.touched">Last Name is required</mat-error>
            </mat-form-field>
          </div>
        </div>
        <div>
          <div *ngIf="availabilityCheck">
            <div class="form-group">
              <mat-form-field class="col-md-6" color="accent" appearance="outline">
                <input type="email" matInput placeholder="Email" [formControl]="bookingEmail" [(ngModel)]="booking.email"
                  required>
                <mat-error *ngIf="!bookingEmail.valid && bookingEmail.touched">Invalid Email Address!</mat-error>
              </mat-form-field>
            </div>
            <div class="form-group">
              <mat-form-field class="col-md-6" color="accent" appearance="outline">
                <input type="text" matInput placeholder="Contact Number" minlength="11" maxlength="13"  [formControl]="bookingContact" [(ngModel)]="booking.mobile"
                  required>
                  <mat-hint>Country Code and phone number +64202020220</mat-hint>
                <mat-error *ngIf="!bookingContact.valid && bookingContact.touched">Invalid Contact Number !</mat-error>
                <mat-error *ngIf="bookingContact.minlength">Invalid Contact Number !</mat-error>
                <mat-error *ngIf="bookingContact.maxlength">Invalid Contact Number !</mat-error>
              </mat-form-field>
            </div>
          </div>
        </div>
        <div *ngIf="booking.available">
          <div class="form-group">
            <mat-form-field class="col-md-6" appearance="outline">
              <mat-select placeholder="Mode of Payment" [(ngModel)]="booking.modeOfPayment" [formControl]="paymentMode"
                required>
                <mat-option *ngFor="let paymentMode of paymentModes" [value]="paymentMode.value">
                  {{ paymentMode.viewValue }}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="!paymentMode.valid && paymentMode.touched">Payment mode is required!</mat-error>
            </mat-form-field>
          </div>
          <div class="form-group" appearance="outline">
            <mat-form-field class="col-md-6" color="accent">
              <span matPrefix>$ &nbsp;</span>
              <input type="text" matInput placeholder="Booking Amount" [formControl]="bookingAmount" [(ngModel)]="booking.payableAmount">
            </mat-form-field>
          </div>
        </div>
        <div *ngIf="booking.modeOfPayment=='Card'">
         <div class="form-group">
            <mat-form-field class="col-md-6" color="accent" appearance="outline">
              <input type="text" matInput placeholder="Card Number" minlength="16"  maxlength="16" pattern="[0-9]{16}" [formControl]="cardNumber" [(ngModel)]="payment.cardNumber"
                required>
              <mat-error *ngIf="!cardNumber.valid && cardNumber.touched">Invalid Card Number!</mat-error>
              <mat-error *ngIf="cardNumber.minlength">Card Number must be 16 digits !</mat-error>
              <mat-error *ngIf="cardNumber.maxlength">Card Number must be 16 digits !</mat-error>
            </mat-form-field>
          </div> 
          <div class="form-group">
            <mat-form-field class="col-md-6" color="accent" appearance="outline">
              <input type="text" matInput placeholder="Name On Card" [formControl]="cardHolderName" [(ngModel)]="payment.cardHolderName"
                required>
              <mat-error *ngIf="!cardHolderName.valid && cardHolderName.touched">Cardholder Name is required!</mat-error>
            </mat-form-field>
          </div>
        </div>
        <div *ngIf="booking.modeOfPayment=='Card'">
          <div class="form-group">
            <mat-form-field class="col-md-4" color="accent" appearance="outline">
              <mat-select placeholder="Expiration Month" [(ngModel)]="payment.expMonth" [formControl]="expMonth">
                <mat-option *ngFor="let month of months" [value]="month.value">
                  {{ month.viewValue }}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="!expMonth.valid && expMonth.touched">Card Expiration Month is required!</mat-error>
            </mat-form-field>
          </div>
          <div class="form-group">
            <mat-form-field class="col-md-4" color="accent" appearance="outline">
              <mat-select placeholder="Expiration Year" [(ngModel)]="payment.expYear" [formControl]="expYear" required>
                <mat-option *ngFor="let year of years" [value]="year.value">
                  {{year.viewValue}}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="!expYear.valid && expYear.touched">Card Expiration Year is required!</mat-error>
            </mat-form-field>
          </div>
          <div class="form-group">
            <mat-form-field class="col-md-4" color="accent" appearance="outline">
              <input type="text" minlength="3"  maxlength="3" matInput placeholder="CVV" [formControl]="cvv" pattern="[0-9]{3}" [(ngModel)]="payment.cvv" required>
              <mat-error *ngIf="!cvv.valid && cvv.touched">Invalid CVV!</mat-error>
              <mat-error *ngIf="cvv.minlength || cvv.maxlength">CVV must be of 3 digits !</mat-error>
            </mat-form-field>
          </div>
        </div>
        <div>
          <div class="form-group">
            <!--mat-spinner *ngIf="spinner"></mat-spinner-->
            <button mat-raised-button type="button" (click)=submit() color="accent" [disabled]="spinner">
              {{bookingButtonLabel}}
            </button>
            &nbsp;&nbsp;
            <button mat-raised-button type="button" (click)=reset() color="accent" [disabled]="spinner">
                Reset
              </button>
          </div>
        </div>
      </form>
    </div>
  </div>
